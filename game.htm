<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>é–‹ç‡ˆéŠæˆ²</title>
    <style>
        body { 
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex; flex-direction: column; align-items: center; 
            font-family: -apple-system; color: white; margin: 0; padding: 20px;
            min-height: 100vh;
        }
        .grid { display: grid; grid-template-columns: repeat(5, 70px); gap: 12px; }
        .light { 
            width: 70px; height: 70px; border-radius: 50%; 
            border: 4px solid #444; cursor: pointer; transition: all 0.2s;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        .light.on { 
            background: linear-gradient(45deg, #fff176, #ffeb3b, #fbc02d);
            box-shadow: 0 0 30px #ffeb3b;
        }
        button { 
            background: linear-gradient(45deg, #4CAF50, #45a049); 
            color: white; border: none; padding: 15px 25px; 
            font-size: 16px; border-radius: 30px; margin: 10px; 
            cursor: pointer; font-weight: bold;
        }
        button:hover { transform: scale(1.05); }
        #status { margin-top: 20px; font-size: 18px; }
    </style>
</head>
<body>
    <h1>ğŸ’¡ é–‹ç‡ˆéŠæˆ² ğŸ’¡</h1>
    <div id="grid" class="grid"></div>
    <div>
        <button onclick="resetGame()">ğŸ”„ é‡ç½®</button>
        <button onclick="randomGame()">ğŸ² éš¨æ©Ÿ</button>
        <button onclick="solveGame()">ğŸ§  è§£ç­”</button>
    </div>
    <div id="status">é»æ“Šé–‹å§‹éŠæˆ²ï¼</div>

    <script>
        let lights = Array(5).fill().map(() => Array(5).fill(0));
        const grid = document.getElementById('grid');
        const status = document.getElementById('status');
        
        function createGrid() {
            grid.innerHTML = '';
            for(let i = 0; i < 5; i++) {
                for(let j = 0; j < 5; j++) {
                    const div = document.createElement('div');
                    div.className = 'light';
                    div.onclick = () => toggle(i, j);
                    grid.appendChild(div);
                }
            }
            updateGrid();
        }
        
        function toggle(x, y) {
            const dirs = [[-1,0],[1,0],[0,-1],[0,1],[0,0]];
            dirs.forEach(([dx, dy]) => {
                const nx = x + dx, ny = y + dy;
                if(nx >= 0 && nx < 5 && ny >= 0 && ny < 5) {
                    lights[nx][ny] = 1 - lights[nx][ny];
                }
            });
            updateGrid();
            setTimeout(checkWin, 150);
        }
        
        function updateGrid() {
            const cells = grid.children;
            for(let i = 0, idx = 0; i < 5; i++) {
                for(let j = 0; j < 5; j++, idx++) {
                    cells[idx].className = `light ${lights[i][j] ? 'on' : ''}`;
                }
            }
        }
        
        function checkWin() {
            if(lights.every(row => row.every(v => v))) {
                status.textContent = 'ğŸ‰ æ­å–œé€šé—œï¼';
            }
        }
        
        function resetGame() {
            lights = Array(5).fill().map(() => Array(5).fill(0));
            updateGrid();
            status.textContent = 'éŠæˆ²å·²é‡ç½®ï¼';
        }
        
        function randomGame() {
            lights = Array(5).fill().map(() => 
                Array(5).fill().map(() => Math.random() > 0.5 ? 1 : 0));
            updateGrid();
            status.textContent = 'ğŸ² æ–°æŒ‘æˆ°ï¼';
        }
        
        // ç‡ˆè¬è§£ç­”æ¼”ç®—æ³• - é«˜æ–¯æ¶ˆå…ƒæ³• (æ¨¡2é‹ç®—)
        function solveGame() {
            // å»ºç«‹ 25x25 å½±éŸ¿çŸ©é™£ A å’Œç›®æ¨™å‘é‡ b (éœ€è¦å…¨äº®ï¼Œæ‰€ä»¥ b å…¨ç‚º 1)
            const N = 25;
            let A = Array(N).fill().map(() => Array(N).fill(0));
            let b = Array(N).fill(1); // ç›®æ¨™ï¼šå…¨äº®(1)
            
            // å¡«å…¥å½±éŸ¿çŸ©é™£ï¼šæ¯å€‹æŒ‰éˆ•å½±éŸ¿è‡ªå·±+å››é„°å±…
            for(let i = 0; i < 5; i++) {
                for(let j = 0; j < 5; j++) {
                    let idx = i * 5 + j;
                    // è‡ªèº«
                    A[idx][idx] = 1;
                    // ä¸Šã€ä¸‹ã€å·¦ã€å³
                    const dirs = [[-1,0],[1,0],[0,-1],[0,1]];
                    for(let [dx, dy] of dirs) {
                        let ni = i + dx, nj = j + dy;
                        if(ni >= 0 && ni < 5 && nj >= 0 && nj < 5) {
                            let nidx = ni * 5 + nj;
                            A[idx][nidx] = 1;
                        }
                    }
                }
            }
            
            // å°‡ç•¶å‰ç‡ˆç‹€æ…‹åŠ å…¥æ–¹ç¨‹ (å¯¦éš›éœ€è¦æŒ‰ä¸‹çš„æ¬¡æ•¸)
            for(let i = 0; i < 5; i++) {
                for(let j = 0; j < 5; j++) {
                    let idx = i * 5 + j;
                    b[idx] = (b[idx] + lights[i][j]) % 2; // æ¨¡2åŠ æ³•
                }
            }
            
            // é«˜æ–¯æ¶ˆå…ƒæ±‚è§£ (æ¨¡2)
            solveGaussian(A, b);
            
            // åŸ·è¡Œè§£ç­”ï¼šæŒ‰ä¸‹éœ€è¦åˆ‡æ›çš„ä½ç½®
            let solution = [];
            for(let i = 0; i < 5; i++) {
                for(let j = 0; j < 5; j++) {
                    let idx = i * 5 + j;
                    if(b[idx]) solution.push([i, j]);
                }
            }
            
            // å‹•æ…‹æ¼”ç¤ºè§£ç­”æ­¥é©Ÿ
            let step = 0;
            function executeStep() {
                if(step < solution.length) {
                    let [x, y] = solution[step];
                    toggle(x, y);
                    step++;
                    setTimeout(executeStep, 300);
                } else {
                    status.textContent = 'ğŸ§  æ•¸å­¸è‡ªå‹•è§£ç­”å®Œæˆï¼';
                }
            }
            executeStep();
        }
        
        // é«˜æ–¯æ¶ˆå…ƒæ³• (æ¨¡2é‹ç®—)
        function solveGaussian(A, b) {
            const N = A.length;
            // å‰å‘æ¶ˆå…ƒ
            for(let p = 0; p < N; p++) {
                // æ‰¾æ¨ç´
                let max = p;
                for(let i = p + 1; i < N; i++) {
                    if(A[i][p] > A[max][p]) max = i;
                }
                // äº¤æ›è¡Œ
                [A[p], A[max]] = [A[max], A[p]];
                [b[p], b[max]] = [b[max], b[p]];
                
                // æ¶ˆå…ƒ
                for(let i = p + 1; i < N; i++) {
                    let alpha = A[i][p];
                    if(alpha) {
                        for(let j = p; j < N; j++) {
                            A[i][j] = (A[i][j] + A[p][j]) % 2;
                        }
                        b[i] = (b[i] + b[p]) % 2;
                    }
                }
            }
            
            // å›ä»£
            for(let i = N - 1; i >= 0; i--) {
                for(let k = N - 1; k > i; k--) {
                    b[i] = (b[i] + A[i][k] * b[k]) % 2;
                }
                if(A[i][i]) b[i] = (b[i] * 1) % 2; // é™¤ä»¥å°è§’å…ƒç´  (æ¨¡2å°±æ˜¯1)
            }
        }
        
        // åˆå§‹åŒ–éŠæˆ²
        createGrid();
    </script>
</body>
</html>
